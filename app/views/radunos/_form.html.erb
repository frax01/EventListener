<%= stylesheet_link_tag 'form' %>

<%= form_with(model: raduno) do |form| %>
  <% if raduno.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(raduno.errors.count, "error") %> prohibited this raduno from being saved:</h2>

      <ul>
        <% raduno.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="centro">

    <div class="field">
      <%= form.label :descrizione, style: "display: block" %>
      <%= form.text_field :descrizione, class: "testo" %>
    </div>

    <div class="field">
      <%= form.label :luogo, style: "display: block" %>
      <%= form.text_field :luogo, class: "testo" %>
    </div>

    <div class="field">
      <%= form.label :data, style: "display: block" %>
      <%= form.date_field :data %>
    </div>

    <div class="field">
      <%= form.label :orario, style: "display: block" %>
      <%= form.time_field :orario %>
    </div>

    <div class="field">
      <%= form.hidden_field :user_id, value: current_user.id %>
    </div>

    <div class="field" style="display: none">
      <%= form.label :nome_darte_organizzatore, style: "display: block" %>
      <%= form.text_field :nome_darte_organizzatore, value: current_user.uid %>
    </div>

    <div class="field" style="display: none">
      <%= form.label :email, style: "display: block" %>
      <%= form.text_field :email, value: current_user.email %>
    </div>

    <div class="field">
      <%= form.submit 'Crea Raduno' %>
    </div>

    <!--Una volta mandata la form bisogna fare:-->
    <!--L'applicazione non appena un Raduno viene modificato manda un messaggio(mail broadcast) a tutti gli iscritti con i cambiamenti apportati. La mail viene mandata solo se c'è almeno un cambiamento nelle informazioni scritte-->
    <!--per prima cosa bisogna verificare se il raduno è stato aggiornato, questo lo si fa vedendo se raduno.created_at!=nil && raduno.created_at!=raduno.updated_at, in caso positivo:-->
    <!--si prendono tutti gli eventi-->
    <!--da questi si controllano quelli che hanno raduno.id=event.raduno_id-->
    <!--da questi si prendono tutti le email_partecipante a cui mandare la mail:-->
    <!--il raduno <%= raduno.id %> è stato modificato -->
  <div>
<% end %>
