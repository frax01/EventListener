<head>
    <%= stylesheet_link_tag 'homepage' %>

    <script>
        function deleteRaduno(radunoId) {
            if (confirm("Sei sicuro di voler eliminare questo raduno?")) {
            // Se l'utente conferma, esegui l'azione di eliminazione
            fetch("/radunos/" + radunoId, {
                method: "DELETE",
                headers: {
                "X-CSRF-Token": "<%= form_authenticity_token %>",
                "Content-Type": "application/json",
                "Accept": "application/json"
                }
            })
            .then(response => {
                if (response.ok) {
                    // Il raduno Ã¨ stato eliminato con successo, aggiorna la pagina o esegui altre azioni necessarie
                    window.location.reload();
                } 
                else {
                    // Gestisci eventuali errori durante l'eliminazione del raduno
                    console.error("Errore durante l'eliminazione del raduno");
                }
                })
                .catch(error => {
                    console.error("Errore durante l'eliminazione del raduno", error);
                });
            }
        }

        function partecipaRaduno() {
            // Copia il contenuto del raduno
            var artista = document.querySelector('.box p:nth-of-type(1)').textContent;
            var descrizione = document.querySelector('.box p:nth-of-type(2)').textContent;
            var data = document.querySelector('.box p:nth-of-type(3)').textContent;
            var orario = document.querySelector('.box p:nth-of-type(4)').textContent;
            var luogo = document.querySelector('.box p:nth-of-type(5)').textContent;
            
            // Crea un nuovo elemento div
            var nuovoRaduno = document.createElement('div');
            nuovoRaduno.className = 'grid-item';
            
            // Crea il contenuto del nuovo elemento div
            var intestazione = document.createElement('div');
            intestazione.className = 'intestazione';
            
            // Crea un nuovo elemento p per ogni informazione del raduno
            var artistaElement = document.createElement('p');
            artistaElement.textContent = artista;
            
            var descrizioneElement = document.createElement('p');
            descrizioneElement.textContent = descrizione;
            
            var dataElement = document.createElement('p');
            dataElement.textContent = data;
            
            var orarioElement = document.createElement('p');
            orarioElement.textContent = orario;
            
            var luogoElement = document.createElement('p');
            luogoElement.textContent = luogo;
            
            // Aggiungi gli elementi p al nuovo elemento div
            nuovoRaduno.appendChild(intestazione);
            nuovoRaduno.appendChild(artistaElement);
            nuovoRaduno.appendChild(descrizioneElement);
            nuovoRaduno.appendChild(dataElement);
            nuovoRaduno.appendChild(orarioElement);
            nuovoRaduno.appendChild(luogoElement);

            // Inserisci il nuovo elemento div nella pagina
            var elemento1 = document.getElementById('elem1');
            elemento1.appendChild(nuovoRaduno);
        }

    </script>

</head>

<body>
    <header>
<%= link_to 'Logout', destroy_user_session_path, :method => :delete, class: 'funzioni-btn' %>
        <div class="grid-containerh">
            <div class="grid-itemh">
                <h1>Ciao <%= @current_user.nome %></h1>
            </div>
            <div class="grid-itemh">
                <div class="titolo">EventListener</div>
            </div>
            <div class="grid-itemh" id="num3">
                <%# if current_user.status=='Artista' %>
                    <%# link_to 'Crea Raduno', new_raduno_path, class: 'funzioni-btn' %> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <%# else %>
                    <%# link_to 'Crea Raduno', new_raduno_path, class: 'funzioni-btn', disabled: true %> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <%# end %>
                <%# if user_signed_in? %>
                    <%# link_to 'Logout', destroy_user_session_path, :method => :delete, class: 'funzioni-btn' %>
                <%# end %>
            </div>
        </div>

    </header>

    <div class="grid-container" id="colonne">
        <div class="grid-item">
            <div class="intestazione">Fan di:</div>
                <% if @fan.present? %>
                    <% @fan.each do |fan| %>
                        <div class="box" id="fan">
                            <p><%= fan %></p>
                        </div>
                    <% end %>
                <% else %>
                    <p>Non sei Fan di nessun artista</p>
                <% end %>
        </div>
        <div class="grid-item">
            <div class="intestazione">Raduni:</div>
        </div>
        <div class="grid-container" id="righe">
            <div class="grid-item" id="elem1">
                <div class="intestazione">Raduni a cui partecipi:</div>
            </div>
            <div class="grid-item" id="elem2">
                <div class="intestazione">Raduni creati:</div>
                <!--implementare la verifiche di utente=artista-->
            </div>
        </div>
    </div>
</body>